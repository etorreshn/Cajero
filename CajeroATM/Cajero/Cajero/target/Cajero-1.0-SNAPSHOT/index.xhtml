<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      lang="es">
<f:view>
    <h:head>
        <title>Menú ATM</title>
        <meta charset="UTF-8" />
        <style type="text/css">
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                font-family: 'Arial', sans-serif;
            }

            body {
                background: linear-gradient(135deg, #1a2a3a, #2c3e50);
                display: flex;
                justify-content: center;
                align-items: center;
                min-height: 100vh;
                padding: 20px;
            }

            .atm-machine {
                width: 800px;
                background: #2c3e50;
                border-radius: 20px;
                box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
                overflow: hidden;
                border: 15px solid #34495e;
                position: relative;
            }

            .atm-header {
                background: #c0392b;
                color: white;
                padding: 15px 30px;
                text-align: center;
                border-bottom: 5px solid #922b21;
            }

            .atm-header h1 {
                font-size: 24px;
                font-weight: bold;
                letter-spacing: 1px;
            }

            .atm-body {
                display: flex;
                padding: 30px;
                background: #34495e;
                gap: 30px;
            }

            .screen-container {
                flex: 1;
                background: #1a252f;
                border-radius: 10px;
                padding: 20px;
                box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
            }

            .atm-screen {
                background: #8bb5e6;
                height: 400px;
                border-radius: 5px;
                padding: 20px 25px 15px 25px;
                display: flex;
                flex-direction: column;
                justify-content: flex-start;
                box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3);
                font-family: 'Courier New', monospace;
                color: #000;
                position: relative;
                overflow: hidden;
            }

            .screen-overlay {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: linear-gradient(135deg, rgba(139, 181, 230, 0.7) 0%, rgba(139, 181, 230, 0.3) 100%);
                pointer-events: none;
            }

            .menu-option {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 8px 15px;
                font-size: 18px;
                font-weight: bold;
                border-bottom: 1px dotted #2c3e50;
                transition: all 0.2s;
            }

            .menu-option:hover {
                background: rgba(52, 73, 94, 0.2);
                cursor: pointer;
            }

            .keypad-container {
                width: 300px;
                background: #2c3e50;
                border-radius: 10px;
                padding: 20px;
            }

            .keypad {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 15px;
                margin-bottom: 20px;
            }

            .key {
                background: #ecf0f1;
                height: 60px;
                border-radius: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 22px;
                font-weight: bold;
                color: #2c3e50;
                box-shadow: 0 4px 0 #bdc3c7;
                cursor: pointer;
                transition: all 0.1s;
                user-select: none;
            }

            .key:active {
                transform: translateY(4px);
                box-shadow: 0 0 0 #bdc3c7;
            }

            .function-keys {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }

            .func-key {
                background: #e67e22;
                height: 50px;
                border-radius: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 16px;
                font-weight: bold;
                color: white;
                box-shadow: 0 4px 0 #d35400;
                cursor: pointer;
                transition: all 0.1s;
                user-select: none;
            }

            .func-key:active {
                transform: translateY(4px);
                box-shadow: 0 0 0 #d35400;
            }

            .card-slot {
                width: 100%;
                height: 10px;
                background: #7f8c8d;
                margin: 20px 0;
                border-radius: 5px;
                position: relative;
            }

            .card-slot::after {
                content: "Inserte su tarjeta aquí";
                position: absolute;
                top: -15px;
                left: 0;
                right: 0;
                text-align: center;
                color: #ecf0f1;
                font-size: 12px;
            }

            .money-slot {
                width: 100%;
                height: 40px;
                background: #7f8c8d;
                margin: 20px 0;
                border-radius: 5px;
                position: relative;
            }

            .money-slot::after {
                content: "Retire su dinero aquí";
                position: absolute;
                top: -15px;
                left: 0;
                right: 0;
                text-align: center;
                color: #ecf0f1;
                font-size: 12px;
            }

            .receipt-slot {
                width: 80%;
                height: 5px;
                background: #7f8c8d;
                margin: 20px auto;
                border-radius: 5px;
                position: relative;
            }

            .receipt-slot::after {
                content: "Comprobante";
                position: absolute;
                top: -20px;
                left: 0;
                right: 0;
                text-align: center;
                color: #ecf0f1;
                font-size: 12px;
            }

            .atm-footer {
                background: #34495e;
                padding: 15px;
                text-align: center;
                color: #ecf0f1;
                font-size: 14px;
                border-top: 2px solid #2c3e50;
            }

            .key-label {
                display: inline-block;
                width: 30px;
                height: 30px;
                background: #e74c3c;
                color: white;
                border-radius: 50%;
                text-align: center;
                line-height: 30px;
                font-size: 14px;
                font-weight: bold;
                margin-left: 10px;
            }

            .option-text {
                flex: 1;
                text-align: left;
            }

            .screen-message {
                text-align: center;
                margin: 10px 0 15px 0;
                font-size: 16px;
                color: #2c3e50;
            }

            .auth-container {
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                height: 100%;
                text-align: center;
                margin-top: 10px;
            }

            .auth-message {
                color: #e74c3c;
                font-weight: bold;
                margin-bottom: 20px;
                font-size: 18px;
            }

            .input-field {
                font-size: 18px;
                padding: 8px;
                margin: 10px 0;
                width: 200px;
                text-align: center;
                border: 2px solid #2c3e50;
                border-radius: 5px;
                background: white;
            }

            .menu-container {
                margin-top: 5px;
            }

            .hidden-submit {
                display: none;
            }
        </style>
    </h:head>

    <h:body>
        <div class="atm-machine">
            <div class="atm-header">
                <h1>BANCO MANCO</h1>
            </div>

            <div class="atm-body">
                <div class="screen-container">
                    <div class="atm-screen">
                        <div class="screen-overlay"></div>

                        <!-- PANTALLA DE LOGIN -->
                        <h:panelGroup rendered="#{empty loginBean.nombreCliente}">
                            <div class="auth-container">
                                <h:form id="loginForm">
                                    <div class="auth-message">
                                        <p>Ingrese su número de cuenta</p>
                                        <h:inputText id="numeroCuenta" value="#{loginBean.numeroCuenta}"
                                                     styleClass="input-field" />

                                        <p style="margin-top: 15px;">Ingrese su PIN</p>
                                        <h:inputSecret id="pin" value="#{loginBean.pin}"
                                                       styleClass="input-field" />

                                        <p style="color: #c0392b; font-weight: bold; margin-top: 10px;">
                                            #{loginBean.mensaje}
                                        </p>
                                    </div>
                                    <h:commandButton id="submitLogin" value="Ingresar" action="#{loginBean.validarLogin}"
                                                     styleClass="hidden-submit" />
                                </h:form>
                            </div>
                        </h:panelGroup>

                        <!-- MENÚ PRINCIPAL -->
                        <h:panelGroup rendered="#{not empty loginBean.nombreCliente}">
                            <div class="screen-message">
                                <p>Por favor, seleccione una opción:</p>
                            </div>

                            <div class="menu-container">
                                <h:form id="menuForm">
                                    <div class="menu-option" onclick="document.getElementById('menuForm:f1').click()">
                                        <span class="option-text">Consultar Saldo</span>
                                        <h:commandButton id="f1" value="F1" action="#{loginBean.consultarSaldo}" style="display: none;" />
                                        <span class="key-label">F1</span>
                                    </div>

                                    <div class="menu-option" onclick="document.getElementById('menuForm:f2').click()">
                                        <span class="option-text">Retiro de efectivo</span>
                                        <h:commandButton id="f2" value="F2" action="retiro.xhtml?faces-redirect=true" style="display: none;" />
                                        <span class="key-label">F2</span>
                                    </div>

                                    <div class="menu-option" onclick="document.getElementById('menuForm:f3').click()">
                                        <span class="option-text">Depósito</span>
                                        <h:commandButton id="f3" value="F3" action="deposito.xhtml?faces-redirect=true" style="display: none;" />
                                        <span class="key-label">F3</span>
                                    </div>

                                    <div class="menu-option" onclick="document.getElementById('menuForm:f4').click()">
                                        <span class="option-text">Transferencia</span>
                                        <h:commandButton id="f4" value="F4" action="transferencia.xhtml?faces-redirect=true" style="display: none;" />
                                        <span class="key-label">F4</span>
                                    </div>

                                    <!-- NUEVA OPCIÓN: Cambio de PIN -->
                                    <div class="menu-option" onclick="document.getElementById('menuForm:f5').click()">
                                        <span class="option-text">Cambio de PIN</span>
                                        <h:commandButton id="f5" value="F5" action="cambioPin.xhtml?faces-redirect=true" style="display: none;" />
                                        <span class="key-label">F5</span>
                                    </div>

                                    <!-- CAMBIADO: F6 ahora es Mini Estado de Cuenta -->
                                    <div class="menu-option" onclick="document.getElementById('menuForm:f6').click()">
                                        <span class="option-text">Mini estado de cuenta</span>
                                        <h:commandButton id="f6" value="F6" action="miniEstadoCuenta.xhtml?faces-redirect=true" style="display: none;" />
                                        <span class="key-label">F6</span>
                                    </div>

                                    <!-- CAMBIADO: F7 ahora es Salir -->
                                    <div class="menu-option" onclick="document.getElementById('menuForm:f7').click()">
                                        <span class="option-text">Salir</span>
                                        <h:commandButton id="f7" value="F7" action="#{loginBean.limpiar}" style="display: none;" />
                                        <span class="key-label">F7</span>
                                    </div>
                                </h:form>
                            </div>
                        </h:panelGroup>
                    </div>

                    <div class="card-slot"></div>
                    <div class="money-slot"></div>
                    <div class="receipt-slot"></div>
                </div>

                <div class="keypad-container">
                    <div class="keypad">
                        <div class="key" data-value="1">1</div>
                        <div class="key" data-value="2">2</div>
                        <div class="key" data-value="3">3</div>
                        <div class="key" data-value="4">4</div>
                        <div class="key" data-value="5">5</div>
                        <div class="key" data-value="6">6</div>
                        <div class="key" data-value="7">7</div>
                        <div class="key" data-value="8">8</div>
                        <div class="key" data-value="9">9</div>
                        <div class="key" data-value=".">.</div>
                        <div class="key" data-value="0">0</div>
                        <div class="key" data-value="clear">C</div>
                    </div>

                    <div class="function-keys">
                        <div class="func-key" data-action="accept">Aceptar</div>
                        <div class="func-key" data-action="cancel">Cancelar</div>
                        <div class="func-key" data-action="correct">Corregir</div>
                        <div class="func-key" data-action="continue">Continuar</div>
                    </div>
                </div>
            </div>

            <div class="atm-footer">
                <p>Operación segura - Para emergencias llame al 0800-123-4567</p>
            </div>
        </div>

        <script type="text/javascript">
            // Variables para el control del teclado
            var currentInput = null;
            var inputValue = '';

            // Función para manejar teclas numéricas
            var keys = document.querySelectorAll('.key[data-value]');
            for (var i = 0; i &lt; keys.length; i++) {
                keys[i].addEventListener('click', function() {
                    var value = this.getAttribute('data-value');

                    if (value === 'clear') {
                        // Limpiar campo actual
                        if (currentInput) {
                            currentInput.value = '';
                            inputValue = '';
                        }
                    } else {
                        // Agregar valor al campo actual
                        if (currentInput) {
                            currentInput.value += value;
                            inputValue += value;
                        }
                    }

                    // Efecto visual
                    this.style.transform = 'translateY(4px)';
                    this.style.boxShadow = '0 0 0 #bdc3c7';
                    var self = this;
                    setTimeout(function() {
                        self.style.transform = '';
                        self.style.boxShadow = '0 4px 0 #bdc3c7';
                    }, 100);
                });
            }

            // Función para manejar botones de función
            var funcKeys = document.querySelectorAll('.func-key');
            for (var j = 0; j &lt; funcKeys.length; j++) {
                funcKeys[j].addEventListener('click', function() {
                    var action = this.getAttribute('data-action');

                    switch(action) {
                        case 'accept':
                            // Enviar formulario de login
                            var submitBtn = document.getElementById('loginForm:submitLogin');
                            if (submitBtn) {
                                submitBtn.click();
                            }
                            break;
                        case 'cancel':
                            // Limpiar campos
                            if (currentInput) {
                                currentInput.value = '';
                                inputValue = '';
                            }
                            break;
                        case 'correct':
                            // Corregir último carácter
                            if (currentInput &amp;&amp; inputValue.length &gt; 0) {
                                inputValue = inputValue.slice(0, -1);
                                currentInput.value = inputValue;
                            }
                            break;
                        case 'continue':
                            // Cambiar entre campos de entrada
                            var cuentaInput = document.getElementById('loginForm:numeroCuenta');
                            var pinInput = document.getElementById('loginForm:pin');

                            if (currentInput === cuentaInput) {
                                currentInput = pinInput;
                            } else if (currentInput === pinInput) {
                                currentInput = cuentaInput;
                            } else {
                                currentInput = cuentaInput;
                            }

                            // Resaltar campo actual
                            if (cuentaInput &amp;&amp; pinInput) {
                                cuentaInput.style.background = '';
                                pinInput.style.background = '';
                            }
                            if (currentInput) {
                                currentInput.style.background = '#f39c12';
                                currentInput.focus();
                            }
                            break;
                    }

                    // Efecto visual
                    this.style.transform = 'translateY(4px)';
                    this.style.boxShadow = '0 0 0 #d35400';
                    var selfFunc = this;
                    setTimeout(function() {
                        selfFunc.style.transform = '';
                        selfFunc.style.boxShadow = '0 4px 0 #d35400';
                    }, 100);
                });
            }

            // Inicializar: seleccionar primer campo automáticamente
            document.addEventListener('DOMContentLoaded', function() {
                var cuentaInput = document.getElementById('loginForm:numeroCuenta');
                if (cuentaInput) {
                    currentInput = cuentaInput;
                    cuentaInput.style.background = '#f39c12';
                }
            });

            // Manejar clic en campos de entrada
            document.addEventListener('click', function(e) {
                if (e.target.id === 'loginForm:numeroCuenta' || e.target.id === 'loginForm:pin') {
                    currentInput = e.target;
                    // Resaltar campo actual
                    var cuentaInput = document.getElementById('loginForm:numeroCuenta');
                    var pinInput = document.getElementById('loginForm:pin');
                    if (cuentaInput &amp;&amp; pinInput) {
                        cuentaInput.style.background = '';
                        pinInput.style.background = '';
                    }
                    currentInput.style.background = '#f39c12';
                }
            });
        </script>
    </h:body>
</f:view>
</html>